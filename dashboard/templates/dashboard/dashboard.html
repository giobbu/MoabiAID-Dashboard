{% extends "dashboard/base.html" %}
{% block title %}
Dashboard
{% endblock %}
{% block stylesheet %}
{{ block.super }}
{% load static %}
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css"
    integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
    crossorigin="" />
<link rel="stylesheet" href="{% static '/dashboard/css/dashboard.css' %}">
{% endblock %}
{% block canonical_url %}
{% endblock %}
{% block shortlink_url %}
{% endblock %}
{% block content %}

{% load crispy_forms_tags %}

<div class="row">
    <nav class="col-md-2 d-none d-md-block bg-light sidebar">
        <div class="sidebar-sticky">
            <ul class="nav flex-column nav-pills" id="dashboard-sidebar" role="tablist" aria-orientation="vertical">
                <li class="nav-item">
                    <a class="nav-link active" id="v-pills-rt-tab" data-toggle="pill" href="#v-pills-rt" role="tab"
                        aria-controls="v-pills-rt" aria-selected="true">
                        <div class="row align-items-center text-center">
                            <img class="img-fluid nav-icon pr-2" src="{% static '/dashboard/images/Real-time.svg' %}"
                                alt="">
                            <span class="sidebar-text">Real-time</span>
                        </div>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="v-pills-maps-tab" data-toggle="pill" href="#v-pills-maps" role="tab"
                        aria-controls="v-pills-rt" aria-selected="true">
                        <div class="row align-items-center text-center">
                            <img class="img-fluid nav-icon pr-2" src="{% static '/dashboard/images/MapIcon.svg' %}"
                                alt="">
                            <span class="sidebar-text">Maps</span>
                        </div>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="v-pills-charts-tab" data-toggle="pill" href="#v-pills-charts" role="tab"
                        aria-controls="v-pills-charts" aria-selected="false">
                        <div class="row align-items-center text-center">
                            <img class="img-fluid nav-icon pr-2" src="{% static '/dashboard/images/Chart_icon.svg' %}"
                                alt="">
                            <span class="sidebar-text">Charts</span>
                        </div>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="v-pills-analytics-tab" data-toggle="pill" href="#v-pills-analytics"
                        role="tab" aria-controls="v-pills-analytics" aria-selected="false">
                        <div class="row align-items-center text-center">
                            <img class="img-fluid nav-icon pr-2"
                                src="{% static '/dashboard/images/analytic-icon.svg' %}" alt="">
                            <span class="sidebar-text">Analytics</span>
                        </div>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="v-pills-pred-tab" data-toggle="pill" href="#v-pills-pred" role="tab"
                        aria-controls="v-pills-pred" aria-selected="false">
                        <div class="row align-items-center text-center">
                            <img class="img-fluid nav-icon pr-2"
                                src="{% static '/dashboard/images/predictions-icon.svg' %}" alt="">
                            <span class="sidebar-text">Predictions</span>
                        </div>
                    </a>
                </li>
            </ul>
        </div>
    </nav>
    <div class="col-md-9">
        <div class="tab-content" id="v-pills-tabContent">
            <div class="tab-pane fade show active" id="v-pills-rt" role="tabpanel" aria-labelledby="v-pills-rt-tab">
                <h1>Real Time</h1>
                <div id="rt-map"></div>
            </div>
            <div class="tab-pane fade" id="v-pills-maps" role="tabpanel" aria-labelledby="v-pills-maps-tab">
                <div class="row">
                    <div class="col">
                        <h1>Maps</h1>
                    </div>
                </div>
                <div class="row">
                    <div class="col-2">
                        <div class="dropdown" id="map-select-drop">
                            <button class="btn btn-secondary dropdown-toggle" type="button" id="select-chart"
                                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Select Map type
                            </button>
                            <div class="dropdown-menu" aria-labelledby="select-chart">
                                <a class="dropdown-item" href="#" data-chart="cat_dist">Trucks per street</a>
                                <a class="dropdown-item" href="#" data-chart="hourly_counts">Trucks per commune</a>
                                <a class="dropdown-item" href="#" data-chart="commune_dist">Truck positions</a>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        {% comment %} TODO: Provide map controls in accordance with chosen map {% endcomment %}
                        <div id="map-controls">
                            {% crispy map_controls%}
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <div id="hist-map"></div>
                    </div>
                </div>
            </div>
            <div class="tab-pane fade" id="v-pills-charts" role="tabpanel" aria-labelledby="v-pills-charts-tab">
                <h1>Charts</h1>
                <div class="dropdown" id="chart-select-drop">
                    <button class="btn btn-secondary dropdown-toggle" type="button" id="select-chart"
                        data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Select Chart
                    </button>
                    <div class="dropdown-menu" aria-labelledby="select-chart">
                        <a class="dropdown-item" href="#" data-chart="cat_dist">Truck Category Distribution</a>
                        <a class="dropdown-item" href="#" data-chart="hourly_counts">Daily Truck counts per hour</a>
                        <a class="dropdown-item" href="#" data-chart="commune_dist">Truck counts per commune</a>
                    </div>
                </div>
                <div class="row chart-row active-chart" id="cat_dist">
                </div>
                {% comment %} Approach: add a div for every chart (with id as chart name) and display/hide divs with
                some controls (dropdown?) {% endcomment %}
            </div>
            <div class="tab-pane fade" id="v-pills-analytics" role="tabpanel" aria-labelledby="v-pills-analytics-tab">
                <h1>Analytics</h1>
            </div>
            <div class="tab-pane fade" id="v-pills-pred" role="tabpanel" aria-labelledby="v-pills-pred-tab">
                <h1>Predictions</h1>
            </div>
        </div>
    </div>


</div>

{% endblock %}
{% block javascript %}
{{ block.super }}
<script src="https://www.amcharts.com/lib/4/core.js"></script>
<script src="https://www.amcharts.com/lib/4/charts.js"></script>
<script src="//www.amcharts.com/lib/4/themes/animated.js"></script>
<script src="https://www.amcharts.com/lib/4/themes/material.js"></script>
<script src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js"
    integrity="sha512-GffPMF3RvMeYyc1LWMHtK8EbPv0iNZ8/oTtHPx9/cc2ILxQ+u905qIwdpULaqDkyBKgOaB57QTMg7ztg8Jm2Og=="
    crossorigin=""></script>
<script src="https://cdn.jsdelivr.net/npm/leaflet-realtime@2/dist/leaflet-realtime.min.js"></script>
<script src="{% static '/dashboard/js/drawUtils.js' %}"></script>
<script src="{% static '/dashboard/js/charts.js' %}"></script>
<script src="{% static '/dashboard/js/maps.js' %}"></script>
<script src="{% static '/dashboard/js/dashboard.js' %}"></script>
{{map_controls.media}}
{% endblock %}